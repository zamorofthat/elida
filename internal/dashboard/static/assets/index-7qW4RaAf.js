(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function l(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(i){if(i.ep)return;i.ep=!0;const r=l(i);fetch(i.href,r)}})();var J,y,ke,T,ae,we,Se,Ce,ie,Z,ee,R={},Fe=[],Be=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Q=Array.isArray;function I(e,t){for(var l in t)e[l]=t[l];return e}function re(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ee(e,t,l){var c,i,r,a={};for(r in t)r=="key"?c=t[r]:r=="ref"?i=t[r]:a[r]=t[r];if(arguments.length>2&&(a.children=arguments.length>3?J.call(arguments,2):l),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)a[r]===void 0&&(a[r]=e.defaultProps[r]);return O(e,a,c,i,null)}function O(e,t,l,c,i){var r={type:e,props:t,key:l,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++ke,__i:-1,__u:0};return i==null&&y.vnode!=null&&y.vnode(r),r}function X(e){return e.children}function j(e,t){this.props=e,this.context=t}function M(e,t){if(t==null)return e.__?M(e.__,e.__i+1):null;for(var l;t<e.__k.length;t++)if((l=e.__k[t])!=null&&l.__e!=null)return l.__e;return typeof e.type=="function"?M(e):null}function xe(e){var t,l;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((l=e.__k[t])!=null&&l.__e!=null){e.__e=e.__c.base=l.__e;break}return xe(e)}}function oe(e){(!e.__d&&(e.__d=!0)&&T.push(e)&&!K.__r++||ae!=y.debounceRendering)&&((ae=y.debounceRendering)||we)(K)}function K(){for(var e,t,l,c,i,r,a,_=1;T.length;)T.length>_&&T.sort(Se),e=T.shift(),_=T.length,e.__d&&(l=void 0,c=void 0,i=(c=(t=e).__v).__e,r=[],a=[],t.__P&&((l=I({},c)).__v=c.__v+1,y.vnode&&y.vnode(l),ce(t.__P,l,c,t.__n,t.__P.namespaceURI,32&c.__u?[i]:null,r,i??M(c),!!(32&c.__u),a),l.__v=c.__v,l.__.__k[l.__i]=l,$e(r,l,a),c.__e=c.__=null,l.__e!=i&&xe(l)));K.__r=0}function De(e,t,l,c,i,r,a,_,u,o,h){var s,f,d,b,C,k,v,p=c&&c.__k||Fe,F=t.length;for(u=Me(l,t,p,u,F),s=0;s<F;s++)(d=l.__k[s])!=null&&(f=d.__i==-1?R:p[d.__i]||R,d.__i=s,k=ce(e,d,f,i,r,a,_,u,o,h),b=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&se(f.ref,null,d),h.push(d.ref,d.__c||b,d)),C==null&&b!=null&&(C=b),(v=!!(4&d.__u))||f.__k===d.__k?u=Pe(d,u,e,v):typeof d.type=="function"&&k!==void 0?u=k:b&&(u=b.nextSibling),d.__u&=-7);return l.__e=C,u}function Me(e,t,l,c,i){var r,a,_,u,o,h=l.length,s=h,f=0;for(e.__k=new Array(i),r=0;r<i;r++)(a=t[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=e.__k[r]=O(null,a,null,null,null):Q(a)?a=e.__k[r]=O(X,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?a=e.__k[r]=O(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):e.__k[r]=a,u=r+f,a.__=e,a.__b=e.__b+1,_=null,(o=a.__i=qe(a,l,u,s))!=-1&&(s--,(_=l[o])&&(_.__u|=2)),_==null||_.__v==null?(o==-1&&(i>h?f--:i<h&&f++),typeof a.type!="function"&&(a.__u|=4)):o!=u&&(o==u-1?f--:o==u+1?f++:(o>u?f--:f++,a.__u|=4))):e.__k[r]=null;if(s)for(r=0;r<h;r++)(_=l[r])!=null&&!(2&_.__u)&&(_.__e==c&&(c=M(_)),He(_,_));return c}function Pe(e,t,l,c){var i,r;if(typeof e.type=="function"){for(i=e.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=e,t=Pe(i[r],t,l,c));return t}e.__e!=t&&(c&&(t&&e.type&&!t.parentNode&&(t=M(e)),l.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function qe(e,t,l,c){var i,r,a,_=e.key,u=e.type,o=t[l],h=o!=null&&(2&o.__u)==0;if(o===null&&_==null||h&&_==o.key&&u==o.type)return l;if(c>(h?1:0)){for(i=l-1,r=l+1;i>=0||r<t.length;)if((o=t[a=i>=0?i--:r++])!=null&&!(2&o.__u)&&_==o.key&&u==o.type)return a}return-1}function _e(e,t,l){t[0]=="-"?e.setProperty(t,l??""):e[t]=l==null?"":typeof l!="number"||Be.test(t)?l:l+"px"}function U(e,t,l,c,i){var r,a;e:if(t=="style")if(typeof l=="string")e.style.cssText=l;else{if(typeof c=="string"&&(e.style.cssText=c=""),c)for(t in c)l&&t in l||_e(e.style,t,"");if(l)for(t in l)c&&l[t]==c[t]||_e(e.style,t,l[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Ce,"$1")),a=t.toLowerCase(),t=a in e||t=="onFocusOut"||t=="onFocusIn"?a.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=l,l?c?l.u=c.u:(l.u=ie,e.addEventListener(t,r?ee:Z,r)):e.removeEventListener(t,r?ee:Z,r);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=l??"";break e}catch{}typeof l=="function"||(l==null||l===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&l==1?"":l))}}function de(e){return function(t){if(this.l){var l=this.l[t.type+e];if(t.t==null)t.t=ie++;else if(t.t<l.u)return;return l(y.event?y.event(t):t)}}}function ce(e,t,l,c,i,r,a,_,u,o){var h,s,f,d,b,C,k,v,p,F,D,N,P,q,A,L,m,g=t.type;if(t.constructor!==void 0)return null;128&l.__u&&(u=!!(32&l.__u),r=[_=t.__e=l.__e]),(h=y.__b)&&h(t);e:if(typeof g=="function")try{if(v=t.props,p="prototype"in g&&g.prototype.render,F=(h=g.contextType)&&c[h.__c],D=h?F?F.props.value:h.__:c,l.__c?k=(s=t.__c=l.__c).__=s.__E:(p?t.__c=s=new g(v,D):(t.__c=s=new j(v,D),s.constructor=g,s.render=Ue),F&&F.sub(s),s.state||(s.state={}),s.__n=c,f=s.__d=!0,s.__h=[],s._sb=[]),p&&s.__s==null&&(s.__s=s.state),p&&g.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=I({},s.__s)),I(s.__s,g.getDerivedStateFromProps(v,s.__s))),d=s.props,b=s.state,s.__v=t,f)p&&g.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),p&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(p&&g.getDerivedStateFromProps==null&&v!==d&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(v,D),t.__v==l.__v||!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(v,s.__s,D)===!1){for(t.__v!=l.__v&&(s.props=v,s.state=s.__s,s.__d=!1),t.__e=l.__e,t.__k=l.__k,t.__k.some(function(B){B&&(B.__=t)}),N=0;N<s._sb.length;N++)s.__h.push(s._sb[N]);s._sb=[],s.__h.length&&a.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(v,s.__s,D),p&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(d,b,C)})}if(s.context=D,s.props=v,s.__P=e,s.__e=!1,P=y.__r,q=0,p){for(s.state=s.__s,s.__d=!1,P&&P(t),h=s.render(s.props,s.state,s.context),A=0;A<s._sb.length;A++)s.__h.push(s._sb[A]);s._sb=[]}else do s.__d=!1,P&&P(t),h=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++q<25);s.state=s.__s,s.getChildContext!=null&&(c=I(I({},c),s.getChildContext())),p&&!f&&s.getSnapshotBeforeUpdate!=null&&(C=s.getSnapshotBeforeUpdate(d,b)),L=h,h!=null&&h.type===X&&h.key==null&&(L=Ie(h.props.children)),_=De(e,Q(L)?L:[L],t,l,c,i,r,a,_,u,o),s.base=t.__e,t.__u&=-161,s.__h.length&&a.push(s),k&&(s.__E=s.__=null)}catch(B){if(t.__v=null,u||r!=null)if(B.then){for(t.__u|=u?160:128;_&&_.nodeType==8&&_.nextSibling;)_=_.nextSibling;r[r.indexOf(_)]=null,t.__e=_}else{for(m=r.length;m--;)re(r[m]);te(t)}else t.__e=l.__e,t.__k=l.__k,B.then||te(t);y.__e(B,t,l)}else r==null&&t.__v==l.__v?(t.__k=l.__k,t.__e=l.__e):_=t.__e=Re(l.__e,t,l,c,i,r,a,u,o);return(h=y.diffed)&&h(t),128&t.__u?void 0:_}function te(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(te)}function $e(e,t,l){for(var c=0;c<l.length;c++)se(l[c],l[++c],l[++c]);y.__c&&y.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(r){r.call(i)})}catch(r){y.__e(r,i.__v)}})}function Ie(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:Q(e)?e.map(Ie):I({},e)}function Re(e,t,l,c,i,r,a,_,u){var o,h,s,f,d,b,C,k=l.props||R,v=t.props,p=t.type;if(p=="svg"?i="http://www.w3.org/2000/svg":p=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(o=0;o<r.length;o++)if((d=r[o])&&"setAttribute"in d==!!p&&(p?d.localName==p:d.nodeType==3)){e=d,r[o]=null;break}}if(e==null){if(p==null)return document.createTextNode(v);e=document.createElementNS(i,p,v.is&&v),_&&(y.__m&&y.__m(t,r),_=!1),r=null}if(p==null)k===v||_&&e.data==v||(e.data=v);else{if(r=r&&J.call(e.childNodes),!_&&r!=null)for(k={},o=0;o<e.attributes.length;o++)k[(d=e.attributes[o]).name]=d.value;for(o in k)if(d=k[o],o!="children"){if(o=="dangerouslySetInnerHTML")s=d;else if(!(o in v)){if(o=="value"&&"defaultValue"in v||o=="checked"&&"defaultChecked"in v)continue;U(e,o,null,d,i)}}for(o in v)d=v[o],o=="children"?f=d:o=="dangerouslySetInnerHTML"?h=d:o=="value"?b=d:o=="checked"?C=d:_&&typeof d!="function"||k[o]===d||U(e,o,d,k[o],i);if(h)_||s&&(h.__html==s.__html||h.__html==e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(s&&(e.innerHTML=""),De(t.type=="template"?e.content:e,Q(f)?f:[f],t,l,c,p=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,a,r?r[0]:l.__k&&M(l,0),_,u),r!=null)for(o=r.length;o--;)re(r[o]);_||(o="value",p=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[o]||p=="progress"&&!b||p=="option"&&b!=k[o])&&U(e,o,b,k[o],i),o="checked",C!=null&&C!=e[o]&&U(e,o,C,k[o],i))}return e}function se(e,t,l){try{if(typeof e=="function"){var c=typeof e.__u=="function";c&&e.__u(),c&&t==null||(e.__u=e(t))}else e.current=t}catch(i){y.__e(i,l)}}function He(e,t,l){var c,i;if(y.unmount&&y.unmount(e),(c=e.ref)&&(c.current&&c.current!=e.__e||se(c,null,t)),(c=e.__c)!=null){if(c.componentWillUnmount)try{c.componentWillUnmount()}catch(r){y.__e(r,t)}c.base=c.__P=null}if(c=e.__k)for(i=0;i<c.length;i++)c[i]&&He(c[i],t,l||typeof e.type!="function");l||re(e.__e),e.__c=e.__=e.__e=void 0}function Ue(e,t,l){return this.constructor(e,l)}function Oe(e,t,l){var c,i,r,a;t==document&&(t=document.documentElement),y.__&&y.__(e,t),i=(c=!1)?null:t.__k,r=[],a=[],ce(t,e=t.__k=Ee(X,null,[e]),i||R,R,t.namespaceURI,i?null:t.firstChild?J.call(t.childNodes):null,r,i?i.__e:t.firstChild,c,a),$e(r,e,a)}J=Fe.slice,y={__e:function(e,t,l,c){for(var i,r,a;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(e)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,c||{}),a=i.__d),a)return i.__E=i}catch(_){e=_}throw e}},ke=0,j.prototype.setState=function(e,t){var l;l=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=I({},this.state),typeof e=="function"&&(e=e(I({},l),this.props)),e&&I(l,e),e!=null&&this.__v&&(t&&this._sb.push(t),oe(this))},j.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),oe(this))},j.prototype.render=X,T=[],we=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Se=function(e,t){return e.__v.__b-t.__v.__b},K.__r=0,Ce=/(PointerCapture)$|Capture$/i,ie=0,Z=de(!1),ee=de(!0);var je=0;function n(e,t,l,c,i,r){t||(t={});var a,_,u=t;if("ref"in u)for(_ in u={},t)_=="ref"?a=t[_]:u[_]=t[_];var o={type:e,props:u,key:l,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--je,__i:-1,__u:0,__source:i,__self:r};if(typeof e=="function"&&(a=e.defaultProps))for(_ in a)u[_]===void 0&&(u[_]=a[_]);return y.vnode&&y.vnode(o),o}var V,w,Y,he,ne=0,Ne=[],S=y,ue=S.__b,fe=S.__r,pe=S.diffed,ve=S.__c,me=S.unmount,ye=S.__;function Le(e,t){S.__h&&S.__h(w,e,ne||t),ne=0;var l=w.__H||(w.__H={__:[],__h:[]});return e>=l.__.length&&l.__.push({}),l.__[e]}function x(e){return ne=1,We(Te,e)}function We(e,t,l){var c=Le(V++,2);if(c.t=e,!c.__c&&(c.__=[Te(void 0,t),function(_){var u=c.__N?c.__N[0]:c.__[0],o=c.t(u,_);u!==o&&(c.__N=[o,c.__[1]],c.__c.setState({}))}],c.__c=w,!w.__f)){var i=function(_,u,o){if(!c.__c.__H)return!0;var h=c.__c.__H.__.filter(function(f){return!!f.__c});if(h.every(function(f){return!f.__N}))return!r||r.call(this,_,u,o);var s=c.__c.props!==_;return h.forEach(function(f){if(f.__N){var d=f.__[0];f.__=f.__N,f.__N=void 0,d!==f.__[0]&&(s=!0)}}),r&&r.call(this,_,u,o)||s};w.__f=!0;var r=w.shouldComponentUpdate,a=w.componentWillUpdate;w.componentWillUpdate=function(_,u,o){if(this.__e){var h=r;r=void 0,i(_,u,o),r=h}a&&a.call(this,_,u,o)},w.shouldComponentUpdate=i}return c.__N||c.__}function z(e,t){var l=Le(V++,3);!S.__s&&ze(l.__H,t)&&(l.__=e,l.u=t,w.__H.__h.push(l))}function Ke(){for(var e;e=Ne.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(W),e.__H.__h.forEach(le),e.__H.__h=[]}catch(t){e.__H.__h=[],S.__e(t,e.__v)}}S.__b=function(e){w=null,ue&&ue(e)},S.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ye&&ye(e,t)},S.__r=function(e){fe&&fe(e),V=0;var t=(w=e.__c).__H;t&&(Y===w?(t.__h=[],w.__h=[],t.__.forEach(function(l){l.__N&&(l.__=l.__N),l.u=l.__N=void 0})):(t.__h.forEach(W),t.__h.forEach(le),t.__h=[],V=0)),Y=w},S.diffed=function(e){pe&&pe(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ne.push(t)!==1&&he===S.requestAnimationFrame||((he=S.requestAnimationFrame)||Ve)(Ke)),t.__H.__.forEach(function(l){l.u&&(l.__H=l.u),l.u=void 0})),Y=w=null},S.__c=function(e,t){t.some(function(l){try{l.__h.forEach(W),l.__h=l.__h.filter(function(c){return!c.__||le(c)})}catch(c){t.some(function(i){i.__h&&(i.__h=[])}),t=[],S.__e(c,l.__v)}}),ve&&ve(e,t)},S.unmount=function(e){me&&me(e);var t,l=e.__c;l&&l.__H&&(l.__H.__.forEach(function(c){try{W(c)}catch(i){t=i}}),l.__H=void 0,t&&S.__e(t,l.__v))};var ge=typeof requestAnimationFrame=="function";function Ve(e){var t,l=function(){clearTimeout(c),ge&&cancelAnimationFrame(t),setTimeout(e)},c=setTimeout(l,35);ge&&(t=requestAnimationFrame(l))}function W(e){var t=w,l=e.__c;typeof l=="function"&&(e.__c=void 0,l()),w=t}function le(e){var t=w;e.__c=e.__(),w=t}function ze(e,t){return!e||e.length!==t.length||t.some(function(l,c){return l!==e[c]})}function Te(e,t){return typeof t=="function"?t(e):t}const $="";function H(e){if(e===0)return"0 B";const t=1024,l=["B","KB","MB","GB"],c=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,c)).toFixed(1))+" "+l[c]}function Ae(e){return e?e.substring(0,8)+"...":"-"}function E({label:e,value:t,className:l}){return n("div",{class:"stat-card",children:[n("div",{class:"stat-label",children:e}),n("div",{class:"stat-value "+(l||""),children:t})]})}function Ge({state:e}){return n("span",{class:"state-badge state-"+e,children:e})}function G({severity:e}){return n("span",{class:"severity-badge severity-"+e,children:e})}function Je(e){if(e.backends_used&&Object.keys(e.backends_used).length>0){const t=Object.entries(e.backends_used);return t.length===1?t[0][0]:t.map(([l,c])=>`${l}(${c})`).join(", ")}try{return new URL(e.backend).host}catch{return e.backend||"-"}}function be({sessions:e,showActions:t,onKill:l,onViewDetails:c}){if(!e||e.length===0)return n("div",{class:"empty-state",children:"No sessions"});const i=r=>{c&&c(r)};return n("table",{children:[n("thead",{children:n("tr",{children:[n("th",{children:"Session ID"}),n("th",{children:"State"}),n("th",{children:"Backends"}),n("th",{children:"Client"}),n("th",{children:"Requests"}),n("th",{children:"Bytes In/Out"}),n("th",{children:"Duration"}),t&&n("th",{children:"Action"})]})}),n("tbody",{children:e.map(r=>n("tr",{class:c?"clickable":"",onClick:()=>i(r),children:[n("td",{class:"mono",children:Ae(r.id)}),n("td",{children:n(Ge,{state:r.state})}),n("td",{class:"mono muted",children:Je(r)}),n("td",{class:"mono muted",children:r.client_addr}),n("td",{children:r.request_count}),n("td",{class:"mono",children:[H(r.bytes_in)," / ",H(r.bytes_out)]}),n("td",{class:"mono",children:r.duration_ms?(r.duration_ms/1e3).toFixed(1)+"s":r.duration}),t&&n("td",{children:n("button",{class:"btn-danger",onClick:a=>{a.stopPropagation(),l(r.id)},disabled:r.state!=="active",children:"Kill"})})]},r.id))})]})}function Qe({session:e,onClose:t}){const[l,c]=x(null);return z(()=>{e!=null&&e.id&&fetch($+"/control/flagged/"+e.id).then(i=>i.ok?i.json():null).then(i=>c(i)).catch(()=>c(null))},[e==null?void 0:e.id]),e?n("div",{class:"modal-overlay",onClick:t,children:n("div",{class:"modal",onClick:i=>i.stopPropagation(),children:[n("div",{class:"modal-header",children:[n("h2",{children:"Session Record"}),n("button",{class:"btn-close",onClick:t,children:"x"})]}),n("div",{class:"modal-body",children:[n("div",{class:"session-metrics",children:n("div",{class:"metrics-grid",children:[n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Session ID"}),n("span",{class:"metric-value mono",children:e.id})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"State"}),n("span",{class:"metric-value state-"+e.state,children:e.state})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Duration"}),n("span",{class:"metric-value",children:e.duration_ms?(e.duration_ms/1e3).toFixed(2)+"s":e.duration})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Requests"}),n("span",{class:"metric-value",children:e.request_count})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Bytes In"}),n("span",{class:"metric-value",children:H(e.bytes_in)})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Bytes Out"}),n("span",{class:"metric-value",children:H(e.bytes_out)})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Backend"}),n("span",{class:"metric-value",children:e.backend})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Client"}),n("span",{class:"metric-value mono",children:e.client_addr})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Started"}),n("span",{class:"metric-value",children:new Date(e.start_time).toLocaleString()})]}),e.end_time&&n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Ended"}),n("span",{class:"metric-value",children:new Date(e.end_time).toLocaleString()})]})]})}),l&&l.violations&&n("div",{children:[n("h3",{children:"Policy Violations"}),n("div",{class:"violations-list",children:l.violations.map((i,r)=>n("div",{class:"violation-item",children:[n("div",{class:"violation-header",children:[n(G,{severity:i.severity}),n("strong",{children:i.rule_name})]}),n("div",{class:"violation-desc",children:i.description}),i.matched_text&&n("div",{class:"violation-match",children:["Matched: ",n("code",{children:i.matched_text})]})]},r))}),l.captured_content&&l.captured_content.length>0&&n("div",{children:[n("h3",{children:"Captured Requests"}),n("div",{class:"captured-list",children:l.captured_content.map((i,r)=>n("div",{class:"captured-item",children:[n("div",{class:"captured-header",children:[n("span",{class:"mono",children:[i.method," ",i.path]}),n("span",{class:"muted",children:new Date(i.timestamp).toLocaleTimeString()})]}),i.request_body&&n("div",{class:"captured-body",children:[n("strong",{children:"Request:"}),n("pre",{children:i.request_body})]})]},r))})]})]})]})]})}):null}function Xe({flagged:e,onViewDetails:t}){return!e||e.length===0?n("div",{class:"empty-state",children:"No flagged sessions - all sessions within policy"}):n("table",{children:[n("thead",{children:n("tr",{children:[n("th",{children:"Session ID"}),n("th",{children:"Severity"}),n("th",{children:"Violations"}),n("th",{children:"First Flagged"}),n("th",{children:"Last Flagged"}),n("th",{children:"Action"})]})}),n("tbody",{children:e.map(l=>n("tr",{children:[n("td",{class:"mono",children:Ae(l.session_id)}),n("td",{children:n(G,{severity:l.max_severity})}),n("td",{children:l.violations.map((c,i)=>n("span",{class:"violation-tag",children:c.rule_name},i))}),n("td",{class:"mono muted",children:new Date(l.first_flagged).toLocaleTimeString()}),n("td",{class:"mono muted",children:new Date(l.last_flagged).toLocaleTimeString()}),n("td",{children:n("button",{class:"btn-secondary",onClick:()=>t(l),children:"View"})})]},l.session_id))})]})}function Ye({flagged:e,onClose:t}){const[l,c]=x(null);return z(()=>{e!=null&&e.session_id&&fetch($+"/control/sessions/"+e.session_id).then(i=>i.ok?i.json():null).then(i=>c(i)).catch(()=>c(null))},[e==null?void 0:e.session_id]),e?n("div",{class:"modal-overlay",onClick:t,children:n("div",{class:"modal",onClick:i=>i.stopPropagation(),children:[n("div",{class:"modal-header",children:[n("h2",{children:"Flagged Session Details"}),n("button",{class:"btn-close",onClick:t,children:"x"})]}),n("div",{class:"modal-body",children:[n("div",{class:"detail-row",children:[n("strong",{children:"Session ID:"})," ",n("span",{class:"mono",children:e.session_id})]}),n("div",{class:"detail-row",children:[n("strong",{children:"Max Severity:"})," ",n(G,{severity:e.max_severity})]}),l&&n("div",{class:"session-metrics",children:[n("h3",{children:"Session Record"}),n("div",{class:"metrics-grid",children:[n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"State"}),n("span",{class:"metric-value state-"+l.state,children:l.state})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Duration"}),n("span",{class:"metric-value",children:l.duration})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Requests"}),n("span",{class:"metric-value",children:l.request_count})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Bytes In"}),n("span",{class:"metric-value",children:H(l.bytes_in)})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Bytes Out"}),n("span",{class:"metric-value",children:H(l.bytes_out)})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Backend"}),n("span",{class:"metric-value",children:l.backend})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Client"}),n("span",{class:"metric-value mono",children:l.client_addr})]}),n("div",{class:"metric",children:[n("span",{class:"metric-label",children:"Started"}),n("span",{class:"metric-value",children:new Date(l.start_time).toLocaleString()})]})]})]}),n("h3",{children:"Violations"}),n("div",{class:"violations-list",children:e.violations.map((i,r)=>n("div",{class:"violation-item",children:[n("div",{class:"violation-header",children:[n(G,{severity:i.severity}),n("strong",{children:i.rule_name})]}),n("div",{class:"violation-desc",children:i.description}),i.matched_text&&n("div",{class:"violation-match",children:["Matched: ",n("code",{children:i.matched_text})]}),i.threshold&&n("div",{class:"violation-stats",children:["Threshold: ",i.threshold," | Actual: ",i.actual_value]})]},r))}),e.captured_content&&e.captured_content.length>0&&n("div",{children:[n("h3",{children:"Captured Requests"}),n("div",{class:"captured-list",children:e.captured_content.map((i,r)=>n("div",{class:"captured-item",children:[n("div",{class:"captured-header",children:[n("span",{class:"mono",children:[i.method," ",i.path]}),n("span",{class:"muted",children:new Date(i.timestamp).toLocaleTimeString()})]}),i.request_body&&n("div",{class:"captured-body",children:[n("strong",{children:"Request:"}),n("pre",{children:i.request_body})]})]},r))})]})]})]})}):null}function Ze(){const[e,t]=x("live"),[l,c]=x({}),[i,r]=x([]),[a,_]=x([]),[u,o]=x([]),[h,s]=x({}),[f,d]=x(null),[b,C]=x(null),[k,v]=x("connecting"),p=async()=>{try{const g=await(await fetch($+"/control/stats")).json();c(g)}catch(m){console.error("Failed to fetch stats:",m)}},F=async()=>{try{const g=await(await fetch($+"/control/sessions")).json();r(g.sessions||[])}catch(m){console.error("Failed to fetch sessions:",m)}},D=async()=>{try{const g=await(await fetch($+"/control/history?limit=50")).json();_(g.sessions||[])}catch(m){console.error("Failed to fetch history:",m)}},N=async()=>{try{const m=await fetch($+"/control/flagged");if(m.status===503){o([]);return}const g=await m.json();o(g.flagged||[])}catch(m){console.error("Failed to fetch flagged:",m)}},P=async()=>{try{const m=await fetch($+"/control/flagged/stats");if(m.status===503){s({});return}const g=await m.json();s(g)}catch(m){console.error("Failed to fetch flagged stats:",m)}},q=async()=>{try{const g=await(await fetch($+"/control/health")).json();v(g.status==="ok"?"connected":"error")}catch{v("disconnected")}},A=async m=>{if(confirm("Kill this session?"))try{await fetch($+"/control/sessions/"+m+"/kill",{method:"POST"}),F(),p()}catch{alert("Failed to kill session")}};z(()=>{p(),F(),P(),q();const m=setInterval(()=>{p(),F(),e==="flagged"&&(N(),P())},2e3),g=setInterval(q,1e4);return()=>{clearInterval(m),clearInterval(g)}},[e]),z(()=>{e==="history"&&D(),e==="flagged"&&(N(),P())},[e]);const L=h.critical>0?"critical":h.warning>0?"warning":"";return n("div",{class:"app",children:[n("header",{class:"header",children:[n("div",{children:[n("h1",{children:"ELIDA"}),n("div",{class:"subtitle",children:"Edge Layer for Intelligent Defense of Agents"})]}),n("div",{class:"status-indicator",children:[n("div",{class:"status-dot "+k}),n("span",{children:k==="connected"?"Connected":k==="disconnected"?"Disconnected":"Connecting..."})]})]}),n("div",{class:"container",children:[n("div",{class:"stats-grid",children:[n(E,{label:"Active Sessions",value:l.active||0,className:"active"}),n(E,{label:"Total Requests",value:l.total_requests||0}),n(E,{label:"Bytes In",value:H(l.total_bytes_in||0)}),n(E,{label:"Bytes Out",value:H(l.total_bytes_out||0)}),n(E,{label:"Killed",value:l.killed||0,className:"killed"}),n(E,{label:"Flagged",value:h.total_flagged||0,className:L})]}),n("div",{class:"tabs",children:[n("button",{class:"tab "+(e==="live"?"active":""),onClick:()=>t("live"),children:"Live Sessions"}),n("button",{class:"tab "+(e==="flagged"?"active":""),onClick:()=>t("flagged"),children:["Flagged (",h.total_flagged||0,")"]}),n("button",{class:"tab "+(e==="history"?"active":""),onClick:()=>t("history"),children:"History"})]}),e==="live"&&n("div",{class:"panel",children:[n("div",{class:"refresh-info",children:"Auto-refreshes every 2 seconds"}),n("div",{class:"table-container",children:n(be,{sessions:i,showActions:!0,onKill:A})})]}),e==="flagged"&&n("div",{class:"panel",children:[n("div",{class:"flagged-summary",children:[n("span",{class:"flagged-stat critical",children:[h.critical||0," Critical"]}),n("span",{class:"flagged-stat warning",children:[h.warning||0," Warning"]}),n("span",{class:"flagged-stat info",children:[h.info||0," Info"]})]}),n("div",{class:"table-container",children:n(Xe,{flagged:u,onViewDetails:d})})]}),e==="history"&&n("div",{class:"panel",children:[n("div",{class:"refresh-info",children:"Click a session to view full record"}),n("div",{class:"table-container",children:n(be,{sessions:a,showActions:!1,onViewDetails:C})})]})]}),f&&n(Ye,{flagged:f,onClose:()=>d(null)}),b&&n(Qe,{session:b,onClose:()=>C(null)})]})}Oe(n(Ze,{}),document.getElementById("root"));
