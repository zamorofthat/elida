(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const _ of o)if(_.type==="childList")for(const s of _.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const _={};return o.integrity&&(_.integrity=o.integrity),o.referrerPolicy&&(_.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?_.credentials="include":o.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function r(o){if(o.ep)return;o.ep=!0;const _=n(o);fetch(o.href,_)}})();var V,m,ke,A,le,we,Se,Fe,re,X,Y,M={},Ce=[],Le=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,z=Array.isArray;function P(e,t){for(var n in t)e[n]=t[n];return e}function _e(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Me(e,t,n){var r,o,_,s={};for(_ in t)_=="key"?r=t[_]:_=="ref"?o=t[_]:s[_]=t[_];if(arguments.length>2&&(s.children=arguments.length>3?V.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(_ in e.defaultProps)s[_]===void 0&&(s[_]=e.defaultProps[_]);return O(e,s,r,o,null)}function O(e,t,n,r,o){var _={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:o??++ke,__i:-1,__u:0};return o==null&&m.vnode!=null&&m.vnode(_),_}function G(e){return e.children}function j(e,t){this.props=e,this.context=t}function L(e,t){if(t==null)return e.__?L(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?L(e):null}function $e(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return $e(e)}}function se(e){(!e.__d&&(e.__d=!0)&&A.push(e)&&!R.__r++||le!=m.debounceRendering)&&((le=m.debounceRendering)||we)(R)}function R(){for(var e,t,n,r,o,_,s,a=1;A.length;)A.length>a&&A.sort(Se),e=A.shift(),a=A.length,e.__d&&(n=void 0,r=void 0,o=(r=(t=e).__v).__e,_=[],s=[],t.__P&&((n=P({},r)).__v=r.__v+1,m.vnode&&m.vnode(n),ie(t.__P,n,r,t.__n,t.__P.namespaceURI,32&r.__u?[o]:null,_,o??L(r),!!(32&r.__u),s),n.__v=r.__v,n.__.__k[n.__i]=n,xe(_,n,s),r.__e=r.__=null,n.__e!=o&&$e(n)));R.__r=0}function He(e,t,n,r,o,_,s,a,h,c,u){var l,f,d,y,F,b,p,v=r&&r.__k||Ce,C=t.length;for(h=Be(n,t,v,h,C),l=0;l<C;l++)(d=n.__k[l])!=null&&(f=d.__i==-1?M:v[d.__i]||M,d.__i=l,b=ie(e,d,f,o,_,s,a,h,c,u),y=d.__e,d.ref&&f.ref!=d.ref&&(f.ref&&oe(f.ref,null,d),u.push(d.ref,d.__c||y,d)),F==null&&y!=null&&(F=y),(p=!!(4&d.__u))||f.__k===d.__k?h=Pe(d,h,e,p):typeof d.type=="function"&&b!==void 0?h=b:y&&(h=y.nextSibling),d.__u&=-7);return n.__e=F,h}function Be(e,t,n,r,o){var _,s,a,h,c,u=n.length,l=u,f=0;for(e.__k=new Array(o),_=0;_<o;_++)(s=t[_])!=null&&typeof s!="boolean"&&typeof s!="function"?(typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?s=e.__k[_]=O(null,s,null,null,null):z(s)?s=e.__k[_]=O(G,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?s=e.__k[_]=O(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):e.__k[_]=s,h=_+f,s.__=e,s.__b=e.__b+1,a=null,(c=s.__i=Ue(s,n,h,l))!=-1&&(l--,(a=n[c])&&(a.__u|=2)),a==null||a.__v==null?(c==-1&&(o>u?f--:o<u&&f++),typeof s.type!="function"&&(s.__u|=4)):c!=h&&(c==h-1?f--:c==h+1?f++:(c>h?f--:f++,s.__u|=4))):e.__k[_]=null;if(l)for(_=0;_<u;_++)(a=n[_])!=null&&!(2&a.__u)&&(a.__e==r&&(r=L(a)),De(a,a));return r}function Pe(e,t,n,r){var o,_;if(typeof e.type=="function"){for(o=e.__k,_=0;o&&_<o.length;_++)o[_]&&(o[_].__=e,t=Pe(o[_],t,n,r));return t}e.__e!=t&&(r&&(t&&e.type&&!t.parentNode&&(t=L(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Ue(e,t,n,r){var o,_,s,a=e.key,h=e.type,c=t[n],u=c!=null&&(2&c.__u)==0;if(c===null&&a==null||u&&a==c.key&&h==c.type)return n;if(r>(u?1:0)){for(o=n-1,_=n+1;o>=0||_<t.length;)if((c=t[s=o>=0?o--:_++])!=null&&!(2&c.__u)&&a==c.key&&h==c.type)return s}return-1}function ce(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Le.test(t)?n:n+"px"}function U(e,t,n,r,o){var _,s;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||ce(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||ce(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")_=t!=(t=t.replace(Fe,"$1")),s=t.toLowerCase(),t=s in e||t=="onFocusOut"||t=="onFocusIn"?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+_]=n,n?r?n.u=r.u:(n.u=re,e.addEventListener(t,_?Y:X,_)):e.removeEventListener(t,_?Y:X,_);else{if(o=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function ae(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=re++;else if(t.t<n.u)return;return n(m.event?m.event(t):t)}}}function ie(e,t,n,r,o,_,s,a,h,c){var u,l,f,d,y,F,b,p,v,C,$,N,D,B,g,S,J,H=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(h=!!(32&n.__u),_=[a=t.__e=n.__e]),(u=m.__b)&&u(t);e:if(typeof H=="function")try{if(p=t.props,v="prototype"in H&&H.prototype.render,C=(u=H.contextType)&&r[u.__c],$=u?C?C.props.value:u.__:r,n.__c?b=(l=t.__c=n.__c).__=l.__E:(v?t.__c=l=new H(p,$):(t.__c=l=new j(p,$),l.constructor=H,l.render=je),C&&C.sub(l),l.state||(l.state={}),l.__n=r,f=l.__d=!0,l.__h=[],l._sb=[]),v&&l.__s==null&&(l.__s=l.state),v&&H.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=P({},l.__s)),P(l.__s,H.getDerivedStateFromProps(p,l.__s))),d=l.props,y=l.state,l.__v=t,f)v&&H.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),v&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(v&&H.getDerivedStateFromProps==null&&p!==d&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(p,$),t.__v==n.__v||!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(p,l.__s,$)===!1){for(t.__v!=n.__v&&(l.props=p,l.state=l.__s,l.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(E){E&&(E.__=t)}),N=0;N<l._sb.length;N++)l.__h.push(l._sb[N]);l._sb=[],l.__h.length&&s.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(p,l.__s,$),v&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(d,y,F)})}if(l.context=$,l.props=p,l.__P=e,l.__e=!1,D=m.__r,B=0,v){for(l.state=l.__s,l.__d=!1,D&&D(t),u=l.render(l.props,l.state,l.context),g=0;g<l._sb.length;g++)l.__h.push(l._sb[g]);l._sb=[]}else do l.__d=!1,D&&D(t),u=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++B<25);l.state=l.__s,l.getChildContext!=null&&(r=P(P({},r),l.getChildContext())),v&&!f&&l.getSnapshotBeforeUpdate!=null&&(F=l.getSnapshotBeforeUpdate(d,y)),S=u,u!=null&&u.type===G&&u.key==null&&(S=Ne(u.props.children)),a=He(e,z(S)?S:[S],t,n,r,o,_,s,a,h,c),l.base=t.__e,t.__u&=-161,l.__h.length&&s.push(l),b&&(l.__E=l.__=null)}catch(E){if(t.__v=null,h||_!=null)if(E.then){for(t.__u|=h?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;_[_.indexOf(a)]=null,t.__e=a}else{for(J=_.length;J--;)_e(_[J]);Z(t)}else t.__e=n.__e,t.__k=n.__k,E.then||Z(t);m.__e(E,t,n)}else _==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):a=t.__e=Oe(n.__e,t,n,r,o,_,s,h,c);return(u=m.diffed)&&u(t),128&t.__u?void 0:a}function Z(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Z)}function xe(e,t,n){for(var r=0;r<n.length;r++)oe(n[r],n[++r],n[++r]);m.__c&&m.__c(t,e),e.some(function(o){try{e=o.__h,o.__h=[],e.some(function(_){_.call(o)})}catch(_){m.__e(_,o.__v)}})}function Ne(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:z(e)?e.map(Ne):P({},e)}function Oe(e,t,n,r,o,_,s,a,h){var c,u,l,f,d,y,F,b=n.props||M,p=t.props,v=t.type;if(v=="svg"?o="http://www.w3.org/2000/svg":v=="math"?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),_!=null){for(c=0;c<_.length;c++)if((d=_[c])&&"setAttribute"in d==!!v&&(v?d.localName==v:d.nodeType==3)){e=d,_[c]=null;break}}if(e==null){if(v==null)return document.createTextNode(p);e=document.createElementNS(o,v,p.is&&p),a&&(m.__m&&m.__m(t,_),a=!1),_=null}if(v==null)b===p||a&&e.data==p||(e.data=p);else{if(_=_&&V.call(e.childNodes),!a&&_!=null)for(b={},c=0;c<e.attributes.length;c++)b[(d=e.attributes[c]).name]=d.value;for(c in b)if(d=b[c],c!="children"){if(c=="dangerouslySetInnerHTML")l=d;else if(!(c in p)){if(c=="value"&&"defaultValue"in p||c=="checked"&&"defaultChecked"in p)continue;U(e,c,null,d,o)}}for(c in p)d=p[c],c=="children"?f=d:c=="dangerouslySetInnerHTML"?u=d:c=="value"?y=d:c=="checked"?F=d:a&&typeof d!="function"||b[c]===d||U(e,c,d,b[c],o);if(u)a||l&&(u.__html==l.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(l&&(e.innerHTML=""),He(t.type=="template"?e.content:e,z(f)?f:[f],t,n,r,v=="foreignObject"?"http://www.w3.org/1999/xhtml":o,_,s,_?_[0]:n.__k&&L(n,0),a,h),_!=null)for(c=_.length;c--;)_e(_[c]);a||(c="value",v=="progress"&&y==null?e.removeAttribute("value"):y!=null&&(y!==e[c]||v=="progress"&&!y||v=="option"&&y!=b[c])&&U(e,c,y,b[c],o),c="checked",F!=null&&F!=e[c]&&U(e,c,F,b[c],o))}return e}function oe(e,t,n){try{if(typeof e=="function"){var r=typeof e.__u=="function";r&&e.__u(),r&&t==null||(e.__u=e(t))}else e.current=t}catch(o){m.__e(o,n)}}function De(e,t,n){var r,o;if(m.unmount&&m.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||oe(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(_){m.__e(_,t)}r.base=r.__P=null}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&De(r[o],t,n||typeof e.type!="function");n||_e(e.__e),e.__c=e.__=e.__e=void 0}function je(e,t,n){return this.constructor(e,n)}function qe(e,t,n){var r,o,_,s;t==document&&(t=document.documentElement),m.__&&m.__(e,t),o=(r=!1)?null:t.__k,_=[],s=[],ie(t,e=t.__k=Me(G,null,[e]),o||M,M,t.namespaceURI,o?null:t.firstChild?V.call(t.childNodes):null,_,o?o.__e:t.firstChild,r,s),xe(_,e,s)}V=Ce.slice,m={__e:function(e,t,n,r){for(var o,_,s;t=t.__;)if((o=t.__c)&&!o.__)try{if((_=o.constructor)&&_.getDerivedStateFromError!=null&&(o.setState(_.getDerivedStateFromError(e)),s=o.__d),o.componentDidCatch!=null&&(o.componentDidCatch(e,r||{}),s=o.__d),s)return o.__E=o}catch(a){e=a}throw e}},ke=0,j.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=P({},this.state),typeof e=="function"&&(e=e(P({},n),this.props)),e&&P(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),se(this))},j.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),se(this))},j.prototype.render=G,A=[],we=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Se=function(e,t){return e.__v.__b-t.__v.__b},R.__r=0,Fe=/(PointerCapture)$|Capture$/i,re=0,X=ae(!1),Y=ae(!0);var Re=0;function i(e,t,n,r,o,_){t||(t={});var s,a,h=t;if("ref"in h)for(a in h={},t)a=="ref"?s=t[a]:h[a]=t[a];var c={type:e,props:h,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Re,__i:-1,__u:0,__source:o,__self:_};if(typeof e=="function"&&(s=e.defaultProps))for(a in s)h[a]===void 0&&(h[a]=s[a]);return m.vnode&&m.vnode(c),c}var W,k,Q,de,ee=0,Te=[],w=m,ue=w.__b,he=w.__r,fe=w.diffed,pe=w.__c,ve=w.unmount,ge=w.__;function Ae(e,t){w.__h&&w.__h(k,e,ee||t),ee=0;var n=k.__H||(k.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function x(e){return ee=1,We(Ee,e)}function We(e,t,n){var r=Ae(W++,2);if(r.t=e,!r.__c&&(r.__=[Ee(void 0,t),function(a){var h=r.__N?r.__N[0]:r.__[0],c=r.t(h,a);h!==c&&(r.__N=[c,r.__[1]],r.__c.setState({}))}],r.__c=k,!k.__f)){var o=function(a,h,c){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(f){return!!f.__c});if(u.every(function(f){return!f.__N}))return!_||_.call(this,a,h,c);var l=r.__c.props!==a;return u.forEach(function(f){if(f.__N){var d=f.__[0];f.__=f.__N,f.__N=void 0,d!==f.__[0]&&(l=!0)}}),_&&_.call(this,a,h,c)||l};k.__f=!0;var _=k.shouldComponentUpdate,s=k.componentWillUpdate;k.componentWillUpdate=function(a,h,c){if(this.__e){var u=_;_=void 0,o(a,h,c),_=u}s&&s.call(this,a,h,c)},k.shouldComponentUpdate=o}return r.__N||r.__}function me(e,t){var n=Ae(W++,3);!w.__s&&ze(n.__H,t)&&(n.__=e,n.u=t,k.__H.__h.push(n))}function Ke(){for(var e;e=Te.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(q),e.__H.__h.forEach(te),e.__H.__h=[]}catch(t){e.__H.__h=[],w.__e(t,e.__v)}}w.__b=function(e){k=null,ue&&ue(e)},w.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ge&&ge(e,t)},w.__r=function(e){he&&he(e),W=0;var t=(k=e.__c).__H;t&&(Q===k?(t.__h=[],k.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(q),t.__h.forEach(te),t.__h=[],W=0)),Q=k},w.diffed=function(e){fe&&fe(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Te.push(t)!==1&&de===w.requestAnimationFrame||((de=w.requestAnimationFrame)||Ve)(Ke)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Q=k=null},w.__c=function(e,t){t.some(function(n){try{n.__h.forEach(q),n.__h=n.__h.filter(function(r){return!r.__||te(r)})}catch(r){t.some(function(o){o.__h&&(o.__h=[])}),t=[],w.__e(r,n.__v)}}),pe&&pe(e,t)},w.unmount=function(e){ve&&ve(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{q(r)}catch(o){t=o}}),n.__H=void 0,t&&w.__e(t,n.__v))};var ye=typeof requestAnimationFrame=="function";function Ve(e){var t,n=function(){clearTimeout(r),ye&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,35);ye&&(t=requestAnimationFrame(n))}function q(e){var t=k,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),k=t}function te(e){var t=k;e.__c=e.__(),k=t}function ze(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function Ee(e,t){return typeof t=="function"?t(e):t}const T="";function K(e){if(e===0)return"0 B";const t=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(1))+" "+n[r]}function Ie(e){return e?e.substring(0,8)+"...":"-"}function I({label:e,value:t,className:n}){return i("div",{class:"stat-card",children:[i("div",{class:"stat-label",children:e}),i("div",{class:"stat-value "+(n||""),children:t})]})}function Ge({state:e}){return i("span",{class:"state-badge state-"+e,children:e})}function ne({severity:e}){return i("span",{class:"severity-badge severity-"+e,children:e})}function Je(e){if(e.backends_used&&Object.keys(e.backends_used).length>0){const t=Object.entries(e.backends_used);return t.length===1?t[0][0]:t.map(([n,r])=>`${n}(${r})`).join(", ")}try{return new URL(e.backend).host}catch{return e.backend||"-"}}function be({sessions:e,showActions:t,onKill:n}){return!e||e.length===0?i("div",{class:"empty-state",children:"No sessions"}):i("table",{children:[i("thead",{children:i("tr",{children:[i("th",{children:"Session ID"}),i("th",{children:"State"}),i("th",{children:"Backends"}),i("th",{children:"Client"}),i("th",{children:"Requests"}),i("th",{children:"Bytes In/Out"}),i("th",{children:"Duration"}),t&&i("th",{children:"Action"})]})}),i("tbody",{children:e.map(r=>i("tr",{children:[i("td",{class:"mono",children:Ie(r.id)}),i("td",{children:i(Ge,{state:r.state})}),i("td",{class:"mono muted",children:Je(r)}),i("td",{class:"mono muted",children:r.client_addr}),i("td",{children:r.request_count}),i("td",{class:"mono",children:[K(r.bytes_in)," / ",K(r.bytes_out)]}),i("td",{class:"mono",children:r.duration_ms?(r.duration_ms/1e3).toFixed(1)+"s":r.duration}),t&&i("td",{children:i("button",{class:"btn-danger",onClick:()=>n(r.id),disabled:r.state!=="active",children:"Kill"})})]},r.id))})]})}function Qe({flagged:e,onViewDetails:t}){return!e||e.length===0?i("div",{class:"empty-state",children:"No flagged sessions - all sessions within policy"}):i("table",{children:[i("thead",{children:i("tr",{children:[i("th",{children:"Session ID"}),i("th",{children:"Severity"}),i("th",{children:"Violations"}),i("th",{children:"First Flagged"}),i("th",{children:"Last Flagged"}),i("th",{children:"Action"})]})}),i("tbody",{children:e.map(n=>i("tr",{children:[i("td",{class:"mono",children:Ie(n.session_id)}),i("td",{children:i(ne,{severity:n.max_severity})}),i("td",{children:n.violations.map((r,o)=>i("span",{class:"violation-tag",children:r.rule_name},o))}),i("td",{class:"mono muted",children:new Date(n.first_flagged).toLocaleTimeString()}),i("td",{class:"mono muted",children:new Date(n.last_flagged).toLocaleTimeString()}),i("td",{children:i("button",{class:"btn-secondary",onClick:()=>t(n),children:"View"})})]},n.session_id))})]})}function Xe({flagged:e,onClose:t}){return e?i("div",{class:"modal-overlay",onClick:t,children:i("div",{class:"modal",onClick:n=>n.stopPropagation(),children:[i("div",{class:"modal-header",children:[i("h2",{children:"Flagged Session Details"}),i("button",{class:"btn-close",onClick:t,children:"x"})]}),i("div",{class:"modal-body",children:[i("div",{class:"detail-row",children:[i("strong",{children:"Session ID:"})," ",i("span",{class:"mono",children:e.session_id})]}),i("div",{class:"detail-row",children:[i("strong",{children:"Max Severity:"})," ",i(ne,{severity:e.max_severity})]}),i("h3",{children:"Violations"}),i("div",{class:"violations-list",children:e.violations.map((n,r)=>i("div",{class:"violation-item",children:[i("div",{class:"violation-header",children:[i(ne,{severity:n.severity}),i("strong",{children:n.rule_name})]}),i("div",{class:"violation-desc",children:n.description}),i("div",{class:"violation-stats",children:["Threshold: ",n.threshold," | Actual: ",n.actual_value]})]},r))}),e.captured_content&&e.captured_content.length>0&&i("div",{children:[i("h3",{children:"Captured Requests"}),i("div",{class:"captured-list",children:e.captured_content.map((n,r)=>i("div",{class:"captured-item",children:[i("div",{class:"captured-header",children:[i("span",{class:"mono",children:[n.method," ",n.path]}),i("span",{class:"muted",children:new Date(n.timestamp).toLocaleTimeString()})]}),n.request_body&&i("div",{class:"captured-body",children:[i("strong",{children:"Request:"}),i("pre",{children:n.request_body})]})]},r))})]})]})]})}):null}function Ye(){const[e,t]=x("live"),[n,r]=x({}),[o,_]=x([]),[s,a]=x([]),[h,c]=x([]),[u,l]=x({}),[f,d]=x(null),[y,F]=x("connecting"),b=async()=>{try{const S=await(await fetch(T+"/control/stats")).json();r(S)}catch(g){console.error("Failed to fetch stats:",g)}},p=async()=>{try{const S=await(await fetch(T+"/control/sessions")).json();_(S.sessions||[])}catch(g){console.error("Failed to fetch sessions:",g)}},v=async()=>{try{const S=await(await fetch(T+"/control/history?limit=50")).json();a(S.sessions||[])}catch(g){console.error("Failed to fetch history:",g)}},C=async()=>{try{const g=await fetch(T+"/control/flagged");if(g.status===503){c([]);return}const S=await g.json();c(S.flagged||[])}catch(g){console.error("Failed to fetch flagged:",g)}},$=async()=>{try{const g=await fetch(T+"/control/flagged/stats");if(g.status===503){l({});return}const S=await g.json();l(S)}catch(g){console.error("Failed to fetch flagged stats:",g)}},N=async()=>{try{const S=await(await fetch(T+"/control/health")).json();F(S.status==="ok"?"connected":"error")}catch{F("disconnected")}},D=async g=>{if(confirm("Kill this session?"))try{await fetch(T+"/control/sessions/"+g+"/kill",{method:"POST"}),p(),b()}catch{alert("Failed to kill session")}};me(()=>{b(),p(),$(),N();const g=setInterval(()=>{b(),p(),e==="flagged"&&(C(),$())},2e3),S=setInterval(N,1e4);return()=>{clearInterval(g),clearInterval(S)}},[e]),me(()=>{e==="history"&&v(),e==="flagged"&&(C(),$())},[e]);const B=u.critical>0?"critical":u.warning>0?"warning":"";return i("div",{class:"app",children:[i("header",{class:"header",children:[i("div",{children:[i("h1",{children:"ELIDA"}),i("div",{class:"subtitle",children:"Edge Layer for Intelligent Defense of Agents"})]}),i("div",{class:"status-indicator",children:[i("div",{class:"status-dot "+y}),i("span",{children:y==="connected"?"Connected":y==="disconnected"?"Disconnected":"Connecting..."})]})]}),i("div",{class:"container",children:[i("div",{class:"stats-grid",children:[i(I,{label:"Active Sessions",value:n.active||0,className:"active"}),i(I,{label:"Total Requests",value:n.total_requests||0}),i(I,{label:"Bytes In",value:K(n.total_bytes_in||0)}),i(I,{label:"Bytes Out",value:K(n.total_bytes_out||0)}),i(I,{label:"Killed",value:n.killed||0,className:"killed"}),i(I,{label:"Flagged",value:u.total_flagged||0,className:B})]}),i("div",{class:"tabs",children:[i("button",{class:"tab "+(e==="live"?"active":""),onClick:()=>t("live"),children:"Live Sessions"}),i("button",{class:"tab "+(e==="flagged"?"active":""),onClick:()=>t("flagged"),children:["Flagged (",u.total_flagged||0,")"]}),i("button",{class:"tab "+(e==="history"?"active":""),onClick:()=>t("history"),children:"History"})]}),e==="live"&&i("div",{class:"panel",children:[i("div",{class:"refresh-info",children:"Auto-refreshes every 2 seconds"}),i("div",{class:"table-container",children:i(be,{sessions:o,showActions:!0,onKill:D})})]}),e==="flagged"&&i("div",{class:"panel",children:[i("div",{class:"flagged-summary",children:[i("span",{class:"flagged-stat critical",children:[u.critical||0," Critical"]}),i("span",{class:"flagged-stat warning",children:[u.warning||0," Warning"]}),i("span",{class:"flagged-stat info",children:[u.info||0," Info"]})]}),i("div",{class:"table-container",children:i(Qe,{flagged:h,onViewDetails:d})})]}),e==="history"&&i("div",{class:"panel",children:[i("div",{class:"refresh-info",children:"Historical sessions from database"}),i("div",{class:"table-container",children:i(be,{sessions:s,showActions:!1})})]})]}),f&&i(Xe,{flagged:f,onClose:()=>d(null)})]})}qe(i(Ye,{}),document.getElementById("root"));
